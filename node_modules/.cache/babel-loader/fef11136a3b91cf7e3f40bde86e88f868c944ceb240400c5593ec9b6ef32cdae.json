{"ast":null,"code":"import { __awaiter as t, __generator as n } from \"tslib\";\nimport { UNKNOWN as r, INIT_FAILED as e, INVALID_CONFIG as i, CREDENTIAL_KEYS as o, PERMANENT_LINK_ORIGIN as a, INVALID_ARGUMENT as s } from \"@liff/consts\";\nimport { createLiffError as c } from \"@liff/util\";\nimport { getContext as f, getConfig as u } from \"@liff/store\";\nimport { getEndPoint as l } from \"@liff/server-api\";\nfunction h(e) {\n  return t(this, void 0, void 0, function () {\n    var t, i;\n    return n(this, function (n) {\n      switch (n.label) {\n        case 0:\n          return [4, fetch(l(\"permanentLink\"), {\n            headers: {\n              \"Content-Type\": \"application/json\",\n              Accept: \"application/json\"\n            },\n            method: \"POST\",\n            body: JSON.stringify(e)\n          })];\n        case 1:\n          return (t = n.sent()).ok ? [3, 3] : [4, t.json()];\n        case 2:\n          throw i = n.sent().message, c(r, i);\n        case 3:\n          return [4, t.json()];\n        case 4:\n          return [2, n.sent()];\n      }\n    });\n  });\n}\nvar p = function () {\n    function r() {\n      var r = this;\n      this.extraParams = \"\", this.getAndValidateContext = function () {\n        var t = f();\n        if (!t) throw c(e, \"Could not get Context from server.\");\n        if (!t.endpointUrl) throw c(e, \"Could not get endpointUrl from server.\");\n        if (!t.permanentLinkPattern) throw c(e, \"Could not get permanentLinkPattern from server.\");\n        return t;\n      }, this.createUrl = function () {\n        var t = r.getAndValidateContext(),\n          n = window.location,\n          e = n.pathname,\n          s = n.search,\n          f = n.hash,\n          l = n.origin,\n          h = new URL(t.endpointUrl);\n        if (h.origin !== l || !r.isAncestor(h.pathname, e)) throw c(i, \"Current page is not under entrypoint.\");\n        var p = e.substring(h.pathname.length);\n        p.length > 0 && \"/\" !== p[0] && (p = \"/\" + p);\n        var m = new RegExp(\"^\".concat(o.join(\"|\"))),\n          d = f.substring(1).split(\"&\").filter(function (t) {\n            return !m.test(t) && Boolean(t);\n          }).join(\"&\"),\n          g = d === h.hash.substring(1) ? \"\" : d,\n          v = function (t) {\n            return t.substring(1).split(\"&\").filter(function (t) {\n              return !/liff\\.state/.test(t) && Boolean(t);\n            });\n          },\n          w = v(s),\n          x = v(h.search);\n        r.extraParams && w.push(r.extraParams);\n        for (var U = 0; U < x.length; U++) {\n          var y = x[U],\n            b = w.indexOf(y);\n          b > -1 && w.splice(b, 1);\n        }\n        var P = w.join(\"&\"),\n          j = \"\".concat(p).concat(\"\" !== P ? \"?\".concat(P) : \"\").concat(g ? \"#\".concat(g) : \"\");\n        return \"\".concat(a).concat(u().liffId).concat(j);\n      }, this.createUrlBy = function (i) {\n        return t(r, void 0, void 0, function () {\n          var t, r;\n          return n(this, function (n) {\n            switch (n.label) {\n              case 0:\n                if (!(t = u().liffId)) throw c(e, \"Should run after liff init.\");\n                try {\n                  r = new URL(i);\n                } catch (o) {\n                  throw c(s, \"invalid URL.\");\n                }\n                return [4, h({\n                  liffId: t,\n                  currentPageUrl: r.toString()\n                })];\n              case 1:\n                return [2, n.sent().permanentLinkUrl];\n            }\n          });\n        });\n      }, this.setExtraQueryParam = function (t) {\n        r.extraParams = t;\n      }, this.isAncestor = function (t, n) {\n        return 0 === n.indexOf(t) && (t.endsWith(\"/\") && (t = t.substring(0, t.length - 1)), void 0 === n[t.length] || \"/\" === n[t.length]);\n      }, this.install = function () {\n        return {\n          createUrl: r.createUrl,\n          createUrlBy: r.createUrlBy,\n          setExtraQueryParam: r.setExtraQueryParam\n        };\n      };\n    }\n    return Object.defineProperty(r.prototype, \"name\", {\n      get: function () {\n        return \"permanentLink\";\n      },\n      enumerable: !1,\n      configurable: !0\n    }), r;\n  }(),\n  m = new p();\nexport { p as PermanentLink, m as module };","map":{"version":3,"names":["__awaiter","t","__generator","n","UNKNOWN","r","INIT_FAILED","e","INVALID_CONFIG","i","CREDENTIAL_KEYS","o","PERMANENT_LINK_ORIGIN","a","INVALID_ARGUMENT","s","createLiffError","c","getContext","f","getConfig","u","getEndPoint","l","h","label","fetch","headers","Accept","method","body","JSON","stringify","sent","ok","json","message","p","extraParams","getAndValidateContext","endpointUrl","permanentLinkPattern","createUrl","window","location","pathname","search","hash","origin","URL","isAncestor","substring","length","m","RegExp","concat","join","d","split","filter","test","Boolean","g","v","w","x","push","U","y","b","indexOf","splice","P","j","liffId","createUrlBy","currentPageUrl","toString","permanentLinkUrl","setExtraQueryParam","endsWith","install","Object","defineProperty","prototype","get","enumerable","configurable","PermanentLink","module"],"sources":["/Users/navamongkoltongta/workspace/sn2/shopassistant-register/node_modules/@liff/permanent-link/lib/index.es.js"],"sourcesContent":["import{__awaiter as t,__generator as n}from\"tslib\";import{UNKNOWN as r,INIT_FAILED as e,INVALID_CONFIG as i,CREDENTIAL_KEYS as o,PERMANENT_LINK_ORIGIN as a,INVALID_ARGUMENT as s}from\"@liff/consts\";import{createLiffError as c}from\"@liff/util\";import{getContext as f,getConfig as u}from\"@liff/store\";import{getEndPoint as l}from\"@liff/server-api\";function h(e){return t(this,void 0,void 0,(function(){var t,i;return n(this,(function(n){switch(n.label){case 0:return[4,fetch(l(\"permanentLink\"),{headers:{\"Content-Type\":\"application/json\",Accept:\"application/json\"},method:\"POST\",body:JSON.stringify(e)})];case 1:return(t=n.sent()).ok?[3,3]:[4,t.json()];case 2:throw i=n.sent().message,c(r,i);case 3:return[4,t.json()];case 4:return[2,n.sent()]}}))}))}var p=function(){function r(){var r=this;this.extraParams=\"\",this.getAndValidateContext=function(){var t=f();if(!t)throw c(e,\"Could not get Context from server.\");if(!t.endpointUrl)throw c(e,\"Could not get endpointUrl from server.\");if(!t.permanentLinkPattern)throw c(e,\"Could not get permanentLinkPattern from server.\");return t},this.createUrl=function(){var t=r.getAndValidateContext(),n=window.location,e=n.pathname,s=n.search,f=n.hash,l=n.origin,h=new URL(t.endpointUrl);if(h.origin!==l||!r.isAncestor(h.pathname,e))throw c(i,\"Current page is not under entrypoint.\");var p=e.substring(h.pathname.length);p.length>0&&\"/\"!==p[0]&&(p=\"/\"+p);var m=new RegExp(\"^\".concat(o.join(\"|\"))),d=f.substring(1).split(\"&\").filter((function(t){return!m.test(t)&&Boolean(t)})).join(\"&\"),g=d===h.hash.substring(1)?\"\":d,v=function(t){return t.substring(1).split(\"&\").filter((function(t){return!/liff\\.state/.test(t)&&Boolean(t)}))},w=v(s),x=v(h.search);r.extraParams&&w.push(r.extraParams);for(var U=0;U<x.length;U++){var y=x[U],b=w.indexOf(y);b>-1&&w.splice(b,1)}var P=w.join(\"&\"),j=\"\".concat(p).concat(\"\"!==P?\"?\".concat(P):\"\").concat(g?\"#\".concat(g):\"\");return\"\".concat(a).concat(u().liffId).concat(j)},this.createUrlBy=function(i){return t(r,void 0,void 0,(function(){var t,r;return n(this,(function(n){switch(n.label){case 0:if(!(t=u().liffId))throw c(e,\"Should run after liff init.\");try{r=new URL(i)}catch(o){throw c(s,\"invalid URL.\")}return[4,h({liffId:t,currentPageUrl:r.toString()})];case 1:return[2,n.sent().permanentLinkUrl]}}))}))},this.setExtraQueryParam=function(t){r.extraParams=t},this.isAncestor=function(t,n){return 0===n.indexOf(t)&&(t.endsWith(\"/\")&&(t=t.substring(0,t.length-1)),void 0===n[t.length]||\"/\"===n[t.length])},this.install=function(){return{createUrl:r.createUrl,createUrlBy:r.createUrlBy,setExtraQueryParam:r.setExtraQueryParam}}}return Object.defineProperty(r.prototype,\"name\",{get:function(){return\"permanentLink\"},enumerable:!1,configurable:!0}),r}(),m=new p;export{p as PermanentLink,m as module};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}